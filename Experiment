import pandas as pd

# Load the data from the Excel file
file_path = '/mnt/data/your_file.xlsx'
df = pd.read_excel(file_path)

# Group by Business Event, ROC, and Age Band and calculate the average Days Spent
grouped_df = df.groupby(['Business Event', 'ROC', 'Age Band'])['Days Spent'].mean().reset_index()

# Sort the values to see which combinations have the highest average Days Spent
sorted_grouped_df = grouped_df.sort_values(by='Days Spent', ascending=False)

# Calculate the occurrences of each combination in the original dataframe
occurrences = df.groupby(['Business Event', 'ROC', 'Age Band']).size().reset_index(name='Occurrences')

# Filter combinations that have at least 10 occurrences
filtered_occurrences = occurrences[occurrences['Occurrences'] >= 10]

# Merge the filtered occurrences with the sorted grouped dataframe
filtered_grouped_df = pd.merge(sorted_grouped_df, filtered_occurrences, on=['Business Event', 'ROC', 'Age Band'])

# Display the filtered result
print(filtered_grouped_df)
