import pandas as pd
import webbrowser
import tkinter as tk
from tkinter import ttk

# Load the Excel file into a DataFrame
excel_file = "your_excel_file.xlsx"
df = pd.read_excel(excel_file)

# Create a function to open the URL based on user selections
def open_selected_url():
    continent = continent_var.get()
    country = country_var.get()
    state = state_var.get()
    district = district_var.get()
    
    # Find the corresponding URL in the DataFrame
    selected_row = df.loc[(df['Continent'] == continent) &
                          (df['Country'] == country) &
                          (df['State'] == state) &
                          (df['District'] == district)]
    
    if not selected_row.empty:
        url = selected_row.iloc[0]['URL']
        webbrowser.open(url)

# Create a GUI window
root = tk.Tk()
root.title("URL Opener")

# Create dropdowns for continent, country, state, and district
continent_var = tk.StringVar()
country_var = tk.StringVar()
state_var = tk.StringVar()
district_var = tk.StringVar()

continent_label = ttk.Label(root, text="Continent:")
continent_label.pack()
continent_dropdown = ttk.Combobox(root, textvariable=continent_var, values=df['Continent'].unique())
continent_dropdown.pack()

country_label = ttk.Label(root, text="Country:")
country_label.pack()
country_dropdown = ttk.Combobox(root, textvariable=country_var, values=df['Country'].unique())
country_dropdown.pack()

state_label = ttk.Label(root, text="State:")
state_label.pack()
state_dropdown = ttk.Combobox(root, textvariable=state_var, values=df['State'].unique())
state_dropdown.pack()

district_label = ttk.Label(root, text="District:")
district_label.pack()
district_dropdown = ttk.Combobox(root, textvariable=district_var, values=df['District'].unique(), state='readonly')
district_dropdown.pack()

# Create a Submit button to open the URL
submit_button = ttk.Button(root, text="Submit", command=open_selected_url)
submit_button.pack()

# Set the window size
root.geometry("400x300")

# Start the GUI application
root.mainloop()
