import os
import pandas as pd

# Set the directory path where your CSV files are located
directory_path = '/path/to/your/csv/files'

# Initialize an empty DataFrame to store the appended data
appended_data = pd.DataFrame()

# Loop through each file in the directory
for filename in os.listdir(directory_path):
    if filename.endswith(".csv"):
        file_path = os.path.join(directory_path, filename)

        # Read each CSV file into a DataFrame
        data = pd.read_csv(file_path)

        # Add a new column with the file name (without extension)
        data['FileName'] = os.path.splitext(filename)[0]

        # Append the data to the main DataFrame
        appended_data = appended_data.append(data, ignore_index=True)

# Write the final appended DataFrame to a new CSV file
appended_data.to_csv('/path/to/your/output/appended_data.csv', index=False)
