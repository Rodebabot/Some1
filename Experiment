import pandas as pd

# Assuming you have already read your CSV into a DataFrame named top_clusters
# top_clusters = pd.read_csv('path_to_csv_file.csv')

# List of action items to include
action_items = [
    "Unactioned", 
    "Counterparty", 
    "Powai Ops - Inbound - Suppression", 
    "Cancelled", 
    "Powai Ops - Inbound - Review", 
    "Transaction Legal Owned", 
    "MO/FO", 
    "Template Negotiation"
]

# Function to filter the top quarter for a given action item excluding "0-5 Days"
def filter_top_quarter(df, action_item):
    filtered_df = df[(df['Action Items'] == action_item) & (df['Age Band'] != '0-5 Days')]
    num_rows = len(filtered_df)
    top_quarter = int(num_rows * 0.25)
    return filtered_df.sort_values(by='Cluster Count', ascending=False).head(top_quarter)

# Create separate DataFrames for each action item
for action_item in action_items:
    df_name = f"df_{action_item.replace(' ', '_').replace('-', '_').replace('/', '_').lower()}"
    globals()[df_name] = filter_top_quarter(top_clusters, action_item)

# Now you can use these DataFrames separately, e.g., df_unactioned, df_counterparty, etc.
