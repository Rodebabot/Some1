import pandas as pd

# Assuming df is your DataFrame with columns 'id' and 'date'
df = pd.read_excel('your_excel_file.xlsx')  # Replace 'your_excel_file.xlsx' with the actual path

# Convert the 'date' column to datetime if it's not already in datetime format
df['date'] = pd.to_datetime(df['date'])

# Group by 'id' and calculate the difference between the highest and lowest dates
date_difference = df.groupby('id')['date'].max() - df.groupby('id')['date'].min()

# Extract the number of days from the timedelta and create a new DataFrame
result_df = pd.DataFrame({'id': date_difference.index, 'days_difference': date_difference.dt.days})

# Print or use the result_df as needed
print(result_df)
