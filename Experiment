import pandas as pd
import tkinter as tk
from tkinter import ttk

def search():
    client_text = client_entry.get().strip()
    
    # Filter the dataframe based on user input
    if client_text:
        filtered_df = df[df['Client Name'] == client_text]
    else:
        filtered_df = df.copy()
    
    # Display filtered dataframe in the treeview
    display_data(filtered_df)

def display_data(data):
    # Clear previous data
    for row in treeview.get_children():
        treeview.delete(row)
    
    # Insert new data
    for i, row in data.iterrows():
        treeview.insert("", "end", values=row.tolist())

# Load Excel data
df = pd.read_excel("your_excel_file.xlsx")

# Create tkinter app
root = tk.Tk()
root.title("Excel Data Viewer")

# Search section
search_frame = ttk.Frame(root)
search_frame.pack(pady=10)

client_label = ttk.Label(search_frame, text="Client Name:")
client_label.grid(row=0, column=0, padx=5, pady=5)

client_entry = ttk.Entry(search_frame)
client_entry.grid(row=0, column=1, padx=5, pady=5)

search_button = ttk.Button(search_frame, text="Search", command=search)
search_button.grid(row=0, column=2, padx=5, pady=5)

# Display section
treeview = ttk.Treeview(root, columns=df.columns, show="headings")

for col in df.columns:
    treeview.heading(col, text=col)

treeview.pack(fill="both", expand=True)

# Display all data initially
display_data(df)

root.mainloop()
