import tkinter as tk
from tkinter import filedialog
from docx import Document

class DocumentComparatorApp:
    def __init__(self, master):
        self.master = master
        master.title("Document Comparator")

        self.file1_path = tk.StringVar()
        self.file2_path = tk.StringVar()

        self.create_widgets()

    def create_widgets(self):
        tk.Label(self.master, text="Select 1st Document:").pack()

        tk.Entry(self.master, textvariable=self.file1_path, width=50).pack()

        tk.Button(self.master, text="Browse", command=self.browse_file1).pack()

        tk.Label(self.master, text="Select 2nd Document:").pack()

        tk.Entry(self.master, textvariable=self.file2_path, width=50).pack()

        tk.Button(self.master, text="Browse", command=self.browse_file2).pack()

        tk.Button(self.master, text="Compare", command=self.compare_documents).pack()

        self.result_label = tk.Label(self.master, text="")
        self.result_label.pack()

    def browse_file1(self):
        self.file1_path.set(filedialog.askopenfilename(filetypes=[("Word Documents", "*.docx")]))

    def browse_file2(self):
        self.file2_path.set(filedialog.askopenfilename(filetypes=[("Word Documents", "*.docx")]))

    def compare_documents(self):
        file1_path = self.file1_path.get()
        file2_path = self.file2_path.get()

        if not file1_path or not file2_path:
            self.result_label.config(text="Please select both documents.")
            return

        doc1 = Document(file1_path)
        doc2 = Document(file2_path)

        diff_lines = set()
        for para2 in doc2.paragraphs:
            if para2.text not in {para1.text for para1 in doc1.paragraphs}:
                diff_lines.add(para2.text)

        result_doc = Document()
        for para in doc2.paragraphs:
            if para.text in diff_lines:
                run = result_doc.add_paragraph().add_run(para.text)
                run.font.highlight_color = 6  # Yellow highlight

        result_path = filedialog.asksaveasfilename(defaultextension=".docx",
                                                    filetypes=[("Word Documents", "*.docx")],
                                                    title="Save Result Document")
        result_doc.save(result_path)
        self.result_label.config(text=f"Comparison completed. Result saved at {result_path}")

# Create and run the Tkinter app
root = tk.Tk()
app = DocumentComparatorApp(root)
root.mainloop()
