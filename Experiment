import pandas as pd

def convert_date_format(df):
    # Function to convert Excel serial number to datetime
    def excel_date_to_datetime(excel_serial):
        return pd.to_datetime('1899-12-30') + pd.to_timedelta(excel_serial, 'D')

    def parse_date(value):
        try:
            # Try to parse the date assuming it's in %Y%m%d format
            return pd.to_datetime(value, format='%Y%m%d')
        except ValueError:
            try:
                # If that fails, try to convert from Excel serial number
                return excel_date_to_datetime(int(value))
            except ValueError:
                # If all else fails, return NaT (Not a Time)
                return pd.NaT

    # Apply the parse_date function to each 'Value Date' entry
    df['Value Date'] = df['Value Date'].apply(parse_date)

    # Convert to the desired format %Y%m%d%H%M%S
    df['Value Date'] = df['Value Date'].dt.strftime('%Y%m%d%H%M%S')
    
    return df

# Apply the function to your dataframe
result_df = convert_date_format(result_df)
