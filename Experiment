import pandas as pd

def calculate_client_delay(row):
  confirmation_status = row["Confirmation Status"]
  dispatched_date = row["Dispatched Date"]
  entry_date = row["Entry Date"]
  today = pd.Timestamp('today')

  if confirmation_status == "Executed":
    client_delay = (row["Confirmation Status changed Date"] - (dispatched_date - entry_date))
  elif confirmation_status == "Outstanding":
    client_delay = today - entry_date
  else:
    # Set client delay to NaN (Not a Number) or any other placeholder for non-processed statuses
    client_delay = pd.NA  # You can change pd.NA to a different placeholder if needed
  return client_delay

# Apply the function to create a new column
df["Client Delay"] = df.apply(calculate_client_delay, axis=1)
