import pandas as pd

# Load the Excel file
file_path = '/mnt/data/depo_projection.xlsx'  # Replace with your actual file path
df = pd.read_excel(file_path)

# Convert 'Pay Date' to datetime
df['Pay Date'] = pd.to_datetime(df['Pay Date'])

# Create a new DataFrame to hold the result
result_df = pd.DataFrame()

# Group by 'Pay Date' and calculate the sum for each group
for date, group in df.groupby('Pay Date'):
    # Append the group to the result DataFrame
    result_df = pd.concat([result_df, group], ignore_index=True)
    
    # Calculate the sum for the group for all columns starting from the 3rd column
    sum_row = group.iloc[:, 2:].sum()
    sum_row['Pay Date'] = 'Total'
    sum_row['Sett Act Ref'] = ''
    
    # Append the sum row to the result DataFrame
    result_df = result_df.append(sum_row, ignore_index=True)

# Save the result to a new Excel file
result_df.to_excel('/mnt/data/summed_file.xlsx', index=False)
