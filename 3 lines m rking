import pandas as pd
from docx import Document

# Read the Excel file
excel_file = 'path/to/your/excel/file.xlsx'
df = pd.read_excel(excel_file)

# Read the Word document
docx_file = 'path/to/your/docx/file.docx'
doc = Document(docx_file)

# Create a dictionary to store the categories for each word
word_categories = {}

# Iterate through each row in the Excel file
for index, row in df.iterrows():
    word = str(row['Word'])  # Assuming 'Word' is the header for the first column
    category = str(row['Category'])  # Assuming 'Category' is the header for the second column
    word_categories[word] = category

# Function to find categories for words in the Word document
def find_categories(text):
    categories_found = []
    for word in word_categories:
        if word in text:
            categories_found.append(word_categories[word])
    return ', '.join(categories_found)

# Extract text from the Word document and find categories
document_text = '\n'.join([paragraph.text for paragraph in doc.paragraphs])
categories_result = find_categories(document_text)

# Create a new DataFrame with the results
result_df = pd.DataFrame({'Word': list(word_categories.keys()), 'Categories Found': [find_categories(document_text) for _ in range(len(word_categories))]})

# Save the result to a new Excel file
result_excel_file = 'path/to/your/result/file.xlsx'
result_df.to_excel(result_excel_file, index=False)

print(f'Results saved to {result_excel_file}')
