import win32com.client

def send_email_confirmation(values, headings):
    confirm = messagebox.askyesno("Confirmation", "Are you sure you want to escalate?")
    if confirm:
        outlook = win32com.client.Dispatch("Outlook.Application")
        mail = outlook.CreateItem(0)
        mail.To = values[-1]  # Assuming last column contains the email
        mail.Subject = "Escalation"
        
        body = "Details of the escalated entry:\n\n"
        for header, value in zip(headings, values[:-1]):
            body += f"{header}: {value}\n"
        
        mail.Body = body
        mail.Send()
        print(f"Email sent to {values[-1]}")
