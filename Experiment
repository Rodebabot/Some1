Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    Dim headerRow As Range
    Dim sCol As Integer
    Dim eCol As Integer
    Dim deltaCol As Integer
    Dim headerCell As Range
    
    ' Find the header row
    Set headerRow = Rows(1)
    
    ' Search for 's', 'e', and 'delta' columns in the header row
    For Each headerCell In headerRow
        If headerCell.Value = "s" Then
            sCol = headerCell.Column
        ElseIf headerCell.Value = "e" Then
            eCol = headerCell.Column
        ElseIf headerCell.Value = "delta" Then
            deltaCol = headerCell.Column
        End If
    Next headerCell
    
    ' Check if the selected cell is in the 's' column
    If Not sCol = 0 And Target.Column = sCol Then
        Dim startTime As Date
        startTime = Now
        Target.Offset(0, deltaCol - sCol).Value = "" ' Clear delta column
        Target.Offset(0, deltaCol - sCol).NumberFormat = "hh:mm:ss" ' Set format for delta column
    End If
    
    ' Check if the selected cell is in the 'e' column
    If Not eCol = 0 And Target.Column = eCol Then
        If IsEmpty(Target.Offset(0, deltaCol - eCol - 1).Value) Then
            MsgBox "Start time is not specified. Please click on 's' first.", vbExclamation
        Else
            Target.Value = Now
            Target.Offset(0, deltaCol - eCol).Value = Target.Value - startTime
            Target.Offset(0, deltaCol - eCol).NumberFormat = "hh:mm:ss" ' Set format for delta column
        End If
    End If
End Sub
