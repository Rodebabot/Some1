import PyPDF2
import nltk
from nltk.tokenize import sent_tokenize
from openpyxl import Workbook

# Download NLTK data if not already present
nltk.download('punkt')

def pdf_to_excel(pdf_file, excel_file):
    # Create a new Excel workbook
    wb = Workbook()
    ws = wb.active

    # Open the PDF file
    with open(pdf_file, 'rb') as file:
        reader = PyPDF2.PdfFileReader(file)
        
        # Iterate through each page of the PDF
        for page_num in range(reader.numPages):
            page = reader.getPage(page_num)
            text = page.extractText()
            
            # Tokenize the text into sentences
            sentences = sent_tokenize(text)
            
            # Write each sentence to a new row in the Excel sheet
            for row_num, sentence in enumerate(sentences, start=1):
                ws.cell(row=row_num, column=1, value=sentence)

    # Save the Excel workbook
    wb.save(excel_file)

# Example usage
pdf_file = 'example.pdf'
excel_file = 'output.xlsx'
pdf_to_excel(pdf_file, excel_file)
