import pandas as pd
from pyOutlook import Outlook

# Connect to Outlook
outlook = Outlook()

# Specify the mailbox and subfolder
mailbox_name = "your_mailbox_name@example.com"
subfolder_name = "Your Subfolder Name"

# Get all emails from the subfolder
emails = outlook.get_emails(mailbox_name, subfolder_name)

# Initialize an empty list to store email bodies
email_bodies = []

# Iterate through emails and extract email bodies with subject containing "inline" (case-insensitive)
for email in emails:
    if "inline" in email.subject.lower():
        email_bodies.append(email.body)

# Create a DataFrame from the email bodies
df = pd.DataFrame({'Email_Body': email_bodies})

# Save the DataFrame to an Excel file
excel_file_name = "email_bodies_with_inline_subject.xlsx"
df.to_excel(excel_file_name, index=False)

# Close the Outlook connection
outlook.close()

print(f"Extracted email bodies with 'inline' (case-insensitive) subject to {excel_file_name}")
