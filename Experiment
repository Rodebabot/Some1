import tkinter as tk
from tkinter import ttk, messagebox
import pandas as pd
import webbrowser
import win32com.client as win32
from datetime import datetime
from PIL import Image, ImageTk

# Load the Excel file into a DataFrame
df = pd.read_excel("your_excel_file.xlsx")

def rank_keywords(input_sentence):
    # ... (rest of your code remains the same)

def show_hover_message(event):
    hover_label.config(text="Hover over close matches for more options.")

def hide_hover_message(event):
    hover_label.config(text="")  # Clear the instruction text

def open_keyword_window():
    keyword_window = tk.Toplevel(root)
    keyword_window.title("Keyword Selection")
    
    # Create a label for the dropdown list
    keyword_label = tk.Label(keyword_window, text="Select a Keyword:")
    keyword_label.grid(row=0, column=0, padx=10, pady=10)
    
    # Get unique keywords from the DataFrame
    unique_keywords = df['Keyword'].unique()
    
    # Create a Combobox (Dropdown) to select a keyword
    selected_keyword = tk.StringVar()
    keyword_combobox = ttk.Combobox(keyword_window, textvariable=selected_keyword, values=unique_keywords, state="readonly")
    keyword_combobox.grid(row=0, column=1, padx=10, pady=10)
    
    def show_display_words():
        selected_kw = selected_keyword.get()
        display_words = []
        for index, row in df.iterrows():
            if row['Keyword'] == selected_kw:
                display_words.append(row['DisplayWord'])
        
        # Create a listbox to display the selected keyword's display words
        display_words_listbox = tk.Listbox(keyword_window, width=50, height=5)
        display_words_listbox.grid(row=1, column=0, columnspan=2, padx=10, pady=10)
        display_words_listbox.bind('<Double-Button-1>', open_url)
        
        # Insert display words into the listbox
        for display_word in display_words:
            display_words_listbox.insert(tk.END, display_word)
    
    # Create a button to show the display words
    submit_button = ttk.Button(keyword_window, text="Submit", command=show_display_words)
    submit_button.grid(row=2, column=0, columnspan=2, padx=10, pady=10)

# Create the main Tkinter window
root = tk.Tk()
root.title("Keyword Search App")

# Load and display the logo image
logo_image = Image.open("logo.png")
logo_photo = ImageTk.PhotoImage(logo_image)
logo_label = tk.Label(root, image=logo_photo)
logo_label.grid(row=0, column=0, columnspan=2, padx=10, pady=10)

# Create and configure the search entry field
entry = ttk.Entry(root, width=30)
entry.grid(row=1, column=0, padx=10, pady=10)

# ... (rest of your code remains the same)

# Create and configure the close matches listbox
close_matches_box = tk.Listbox(root, width=50, height=5)
close_matches_box.grid(row=2, column=0, columnspan=2, padx=10, pady=10)
close_matches_box.bind('<Double-Button-1>', open_url)
close_matches_box.bind('<Enter>', show_hover_message)
close_matches_box.bind('<Leave>', hide_hover_message)

# Create a label for the hover instruction
hover_label = tk.Label(root, text="", foreground="gray")
hover_label.grid(row=3, column=0, columnspan=2, padx=10, pady=5)

# Create a button to open the keyword selection window
keyword_button = ttk.Button(root, text="Select Keyword", command=open_keyword_window)
keyword_button.grid(row=4, column=0, columnspan=2, padx=10, pady=10)

root.mainloop()
