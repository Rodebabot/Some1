import os
import win32com.client

def fetch_attachment_from_outlook(mailbox_name, folder_name, subfolder_name, save_location):
    outlook = win32com.client.Dispatch("Outlook.Application").GetNamespace("MAPI")
    mailbox = outlook.Folders.Item(mailbox_name)
    inbox = mailbox.Folders.Item("Inbox")
    folder = inbox.Folders.Item(folder_name)
    subfolder = folder.Folders.Item(subfolder_name)

    # Get the 2nd latest mail
    mails = subfolder.Items
    mails.Sort("[ReceivedTime]", True)
    second_latest_mail = mails.Item(2)

    # Check if there are attachments
    if second_latest_mail.Attachments.Count > 0:
        for attachment in second_latest_mail.Attachments:
            attachment.SaveAsFile(os.path.join(save_location, attachment.FileName))
            print(f"Attachment '{attachment.FileName}' saved successfully.")

# Usage example
fetch_attachment_from_outlook("Mailbox Name", "Inbox", "Subfolder Name", "C:/Attachments")
