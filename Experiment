import pandas as pd
from shareplum import Site
from shareplum.site import Version

# SharePoint site credentials and URL
username = "your_username"
password = "your_password"
site_url = "https://your-sharepoint-site.com/sites/your-site"

# Excel file path
excel_file_path = "path/to/your/excel/file.xlsx"

# SharePoint library name
library_name = "Documents"

try:
    # Connect to SharePoint site
    site = Site(site_url, version=Version.v365, auth=(username, password))

    # Get the library
    library = site.List(library_name)

    # Read Excel data into a DataFrame
    excel_data = pd.read_excel(excel_file_path)

    # Convert DataFrame to a list of dictionaries (each row becomes a dictionary)
    data_to_upload = excel_data.to_dict(orient="records")





import os
import pandas as pd

folder_path = '/path/to/your/folder'
output_excel_file = '/path/to/output/combined_file.xlsx'

# Initialize an empty DataFrame to store the combined data
combined_data = pd.DataFrame()

# Iterate through all files in the folder
for filename in os.listdir(folder_path):
    file_path = os.path.join(folder_path, filename)
    
    # Check if the file is an Excel file
    if file_path.endswith('.xlsx') or file_path.endswith('.xls'):
        # Read the Excel file into a DataFrame
        excel_data = pd.read_excel(file_path)
        
        # Append the data to the combined DataFrame
        combined_data = combined_data.append(excel_data, ignore_index=True)

# Write the combined data to a new Excel file
combined_data.to_excel(output_excel_file, index=False)

    # Upload data to SharePoint
    for item in data_to_upload:
        try:
            library.add_item(item)
        except Exception as e:
            print(f"Error uploading item: {item}. Error: {e}")

    print("Data uploaded successfully to SharePoint.")

except Exception as e:
    print(f"Error connecting to SharePoint. Error: {e}")






import os
import pandas as pd

folder_path = '/path/to/your/folder'
output_excel_file = '/path/to/output/combined_file.xlsx'

# Initialize an empty list to store DataFrames
dfs = []

# Iterate through all files in the folder
for filename in os.listdir(folder_path):
    file_path = os.path.join(folder_path, filename)
    
    # Check if the file is an Excel file
    if file_path.endswith('.xlsx') or file_path.endswith('.xls'):
        # Read the Excel file into a DataFrame and append it to the list
        excel_data = pd.read_excel(file_path)
        dfs.append(excel_data)

# Concatenate all DataFrames in the list
combined_data = pd.concat(dfs, ignore_index=True)

# Write the combined data to a new Excel file
combined_data.to_excel(output_excel_file, index=False)
