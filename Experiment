import os
import pandas as pd

folder_path = 'path/to/your/excel/files'

# Create an empty dataframe to store the appended data
appended_df = pd.DataFrame()

# Iterate through all Excel files in the specified folder
for file_name in os.listdir(folder_path):
    if file_name.endswith('.xlsx') or file_name.endswith('.xls'):
        file_path = os.path.join(folder_path, file_name)
        
        # Read each Excel file and append its data to the main dataframe
        df = pd.read_excel(file_path, engine='openpyxl', skiprows=3)
        appended_df = pd.concat([appended_df, df], ignore_index=True)

# Write the appended dataframe to a new Excel file
output_file = 'path/to/your/output/folder/appended_data.xlsx'
appended_df.to_excel(output_file, index=False)









import os
import pandas as pd

folder_path = 'path/to/your/excel/files'

# Get the list of Excel files in the specified folder
excel_files = [file for file in os.listdir(folder_path) if file.endswith('.xlsx') or file.endswith('.xls')]

# Ensure there is only one Excel file in the folder
if len(excel_files) == 1:
    file_name = excel_files[0]
    file_path = os.path.join(folder_path, file_name)

    # Read the Excel file
    df = pd.read_excel(file_path, engine='openpyxl')

    # Remove duplicate rows based on all values in a row
    df_deduplicated = df.drop_duplicates()

    # Overwrite the original Excel file with the deduplicated data
    df_deduplicated.to_excel(file_path, index=False)
    print(f"Deduplicated data overwritten to {file_name}")
else:
    print("There should be exactly one Excel file in the specified folder.")
