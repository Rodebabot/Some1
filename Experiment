import os
import pandas as pd

# Set the directory path where your CSV files are located
directory_path = '/path/to/your/csv/files'

# Initialize an empty list to store DataFrames
dfs = []

# Loop through each file in the directory
for filename in os.listdir(directory_path):
    if filename.endswith(".csv"):
        file_path = os.path.join(directory_path, filename)

        # Read each CSV file into a DataFrame
        data = pd.read_csv(file_path)

        # Add a new column with the file name (without extension)
        data['FileName'] = os.path.splitext(filename)[0]

        # Append the DataFrame to the list
        dfs.append(data)

# Concatenate all DataFrames in the list
appended_data = pd.concat(dfs, ignore_index=True)

# Write the final appended DataFrame to a new CSV file
appended_data.to_csv('/path/to/your/output/appended_data.csv', index=False)
