import pandas as pd

# Load the newly created dataset
file_path = 'ROC_analysis_with_groups_and_popularity.xlsx'  # Replace with the actual file path
df = pd.read_excel(file_path)

# Define the tagging logic
def assign_tag(row):
    if row['Group'] == 'Consistently Bad' and row['Popularity Tag'] == 'High':
        if row['Owner'] == 'External Dependency':
            return 1
        elif row['Owner'] == 'Internal Dependency':
            return 2
        elif row['Owner'] == 'Ops Action':
            return 3
    elif row['Popularity Tag'] == 'High' and (row['Group'] == 'Sometimes Bad' or row['Group'] == 'Sometimes Good'):
        return 4
    return None

# Apply the tagging logic to the dataframe
df['Tag'] = df.apply(assign_tag, axis=1)

# Save the updated dataframe to a new Excel file
df.to_excel('ROC_analysis_with_custom_tags.xlsx', index=False)
print("ROC analysis with custom tags has been saved to 'ROC_analysis_with_custom_tags.xlsx'")
