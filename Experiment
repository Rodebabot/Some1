from shareplum import Site
from shareplum.site import Version

# SharePoint site credentials and URL
username = "your_username"
password = "your_password"
site_url = "https://your-sharepoint-site.com/sites/your-site"

# Local path to your Excel file
excel_file_path = "path/to/your/excel/file.xlsx"

# SharePoint library name
library_name = "Documents"

# Connect to SharePoint site
site = Site(site_url, version=Version.v365, auth=(username, password))

# Get the library
library = site.List(library_name)

# Upload the Excel file to SharePoint
with open(excel_file_path, "rb") as file:
    data = file.read()
    library.Folder("/").upload_file(file_name="your_file_name.xlsx", file_data=data)

print("Excel file uploaded successfully to SharePoint.")
