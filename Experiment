import os
import pandas as pd
import datetime

# Get today's date in the format "ddmm"
current_day_month = datetime.datetime.now().strftime("%d%m")

# Specify the parent directory to search
parent_directory_path = "/path/to/parent/directory"

# List files in the parent directory
files = [f for f in os.listdir(parent_directory_path) if os.path.isfile(os.path.join(parent_directory_path, f))]

# Filter Excel files with today's date in the filename
excel_files_today = [f for f in files if f.endswith('.xlsx') and current_day_month in f]

# If there's an Excel file with today's date in the filename, read it
if excel_files_today:
    excel_file_path = os.path.join(parent_directory_path, excel_files_today[0])
    print("Found Excel file for today:", excel_file_path)

    # Store the name of the Excel file without extension
    excel_file_name = os.path.splitext(excel_files_today[0])[0]

    try:
        # Read all sheets from the Excel file
        all_dfs = pd.read_excel(excel_file_path, sheet_name=None)
    except Exception as e:
        print("Error reading Excel file:", e)
        raise

    # Access each DataFrame individually
    df1 = all_dfs['Sheet1']  # Change 'Sheet1' to the actual sheet name
    df2 = all_dfs['Sheet2']  # Change 'Sheet2' to the actual sheet name
    df3 = all_dfs['Sheet3']  # Change 'Sheet3' to the actual sheet name
    df4 = all_dfs['Sheet4']  # Change 'Sheet4' to the actual sheet name

    # Example usage of the DataFrames
    print(df1.head())
    print(df2.head())
    print(df3.head())
    print(df4.head())
else:
    print("No Excel file found for today.")
