import pandas as pd
import win32com.client
import os
from datetime import datetime

# Load the Excel file into a pandas DataFrame
excel_file = 'path_to_your_excel_file.xlsx'
df = pd.read_excel(excel_file)

# Connect to Outlook
outlook = win32com.client.Dispatch("Outlook.Application").GetNamespace("MAPI")

# Replace 'SubfolderName' with the name of the subfolder where you want to check for emails
inbox = outlook.GetDefaultFolder(6).Folders['SubfolderName'].Items

# Loop through each email in the subfolder
for email in inbox:
    sender = email.SenderEmailAddress
    subject = email.Subject
    received_date = email.ReceivedTime.date()
    today = datetime.today().date()

    # Check if the email was received today and if the combination of sender and subject exists in the DataFrame
    if received_date == today and not df[(df['SenderName'] == sender) & (df['Subject'] == subject)].empty:
        # Get the folder location from the first matched row
        folder_location = df[(df['SenderName'] == sender) & (df['Subject'] == subject)].iloc[0]['FolderLocation']

        # Save the attachments in the corresponding location
        for attachment in email.Attachments:
            attachment.SaveAsFile(os.path.join(folder_location, attachment.FileName))

print("Attachments from today's emails saved successfully.")


import pandas as pd

# Define the file path for your CSV file
csv_file_path = 'your_file.csv'

# Import the CSV into a DataFrame
df = pd.read_csv(csv_file_path)

# Display the first few rows of the DataFrame
print(df.head())

# Export the DataFrame to an Excel file with the same name
excel_file_path = csv_file_path.replace('.csv', '.xlsx')
df.to_excel(excel_file_path, index=False)

print(f'DataFrame exported to {excel_file_path}')



