import os
import win32com.client
import datetime

# Function to save attachments from the latest 4 mails in a specific subfolder
def save_attachments_from_outlook(folder_path):
    # Connect to Outlook
    outlook = win32com.client.Dispatch("Outlook.Application").GetNamespace("MAPI")

    # Get the specified mailbox and subfolders
    mailbox = outlook.Folders.Item("Gloss Control India")
    inbox = mailbox.Folders.Item("Inbox")
    daily_files = inbox.Folders.Item("Daily Files")
    tm = daily_files.Folders.Item("TM")
    sevg_and_tver = tm.Folders.Item("SEVG AND TVER")

    # Get the latest 4 mails
    mails = sevg_and_tver.Items
    mails.Sort("[ReceivedTime]", True)
    latest_4_mails = mails[:4]

    # Save attachments from the latest 4 mails
    for mail in latest_4_mails:
        for attachment in mail.Attachments:
            attachment.SaveAsFile(os.path.join(folder_path, attachment.FileName))
            print(f"Attachment saved: {attachment.FileName}")

# Specify the folder path to save attachments
folder_path = '/path/to/save/attachments'

# Call the function to save attachments from Outlook
save_attachments_from_outlook(folder_path)
