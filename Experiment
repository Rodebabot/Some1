import pandas as pd
import os

# Specify the directory containing the Excel files
directory = 'path/to/your/files'

# Initialize an empty list to hold the DataFrames
dataframes = []

# Loop through the files in the directory
for filename in os.listdir(directory):
    if '18' in filename and filename.endswith('.xlsx'):
        # Read the Excel file into a DataFrame
        file_path = os.path.join(directory, filename)
        df = pd.read_excel(file_path)
        dataframes.append((filename, df))

# Create a new Excel writer object
output_path = os.path.join(directory, 'merged_file.xlsx')
with pd.ExcelWriter(output_path, engine='openpyxl') as writer:
    for i, (filename, df) in enumerate(dataframes):
        # Write each DataFrame to a different sheet
        df.to_excel(writer, sheet_name=f'Sheet{i+1}', index=False)

print(f'New Excel file created at {output_path}')
