import pandas as pd

# Read the first dataset from CSV
df1 = pd.read_csv('/path/to/your/first_dataset.csv')

# Read the second dataset from CSV
df2 = pd.read_csv('/path/to/your/second_dataset.csv')

# Identify common columns dynamically
common_columns = list(set(df1.columns) & set(df2['Col1'].unique()))

# Filter df1 to include only the common columns
filtered_df1 = df1[common_columns]

# Perform element-wise multiplication
result = filtered_df1 * df2.set_index('Col1').loc[common_columns, 'Col2']

# Create the final DataFrame with the desired format
final_df = pd.DataFrame({
    'Column1': [df1.iloc[0, 0]],  # Assuming the first value of the first column as the header
    'Column2': [result.sum().sum()],
    'Column3': [result.product().product()]
})

# Display the final DataFrame
print(final_df)


final_df1 = pd.concat([df1.drop(columns=common_columns), result], axis=1
