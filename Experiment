import pandas as pd

# Load the dataset
file_path = '/mnt/data/your_excel_file.xlsx'  # Replace with the actual file path
df = pd.read_excel(file_path)

# Ensure the column names are correct as per the provided screenshot
df.columns = ['Unique Eventid', 'Legal Entity', 'Trade ID', 'ROC', 'Age', 'Age Band', 'Counterparty Name', 'Business Event', 'Product Representation', 'Days Spent', 'Action Items']

# Group by ROC and Age Band to calculate the average days spent
roc_age_band_stats = df.groupby(['ROC', 'Age Band'])['Days Spent'].mean().reset_index()

# Filter ROCs where the average days spent is more than 2
bottlenecks = roc_age_band_stats[roc_age_band_stats['Days Spent'] > 2]

# Display the bottlenecks
print(bottlenecks)

# Save the bottlenecks to an Excel file
bottlenecks.to_excel('/mnt/data/roc_bottlenecks.xlsx', index=False)

print("Bottlenecks saved to roc_bottlenecks.xlsx")
