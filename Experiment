import pandas as pd
import numpy as np

# Assuming df is your DataFrame with columns 'id', 'roc', and 'date'
df = pd.read_excel('your_excel_file.xlsx')  # Replace 'your_excel_file.xlsx' with the actual path

# Convert the 'date' column to datetime if it's not already in datetime format
df['date'] = pd.to_datetime(df['date'])

# Group by 'id' and 'roc', then calculate the net working days
working_days = df.groupby(['id', 'roc'])['date'].apply(lambda x: np.busday_count(x.min(), x.max()))

# Create a new DataFrame
result_df = pd.DataFrame({'id': working_days.index.get_level_values('id'),
                          'roc': working_days.index.get_level_values('roc'),
                          'working_days_difference': working_days})

# Pivot the DataFrame to turn 'roc' values into columns
pivoted_df = result_df.pivot_table(index='id', columns='roc', values='working_days_difference', aggfunc='first')

# Reset the index if needed
pivoted_df.reset_index(inplace=True)

# Print or use the pivoted_df as needed
print(pivoted_df)
