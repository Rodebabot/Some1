import os
import pandas as pd

# Specify the directory containing the .dat file
directory_path = '/path/to/directory'

# Iterate over the files in the directory
for filename in os.listdir(directory_path):
    if filename.endswith('.dat'):
        dat_file_path = os.path.join(directory_path, filename)
        xlsx_file_path = os.path.join(directory_path, f"{filename[:-4]}.xlsx")  # Change extension to .xlsx

        # Read the .dat file as binary
        with open(dat_file_path, 'rb') as f:
            # Read the binary data from the .dat file
            binary_data = f.read()

        # Write the binary data to a .xlsx file
        with open(xlsx_file_path, 'wb') as f:
            # Write the binary data to the .xlsx file
            f.write(binary_data)

        # Optionally, you can use Pandas to read the .xlsx file and perform further processing if needed
        # df = pd.read_excel(xlsx_file_path)

        print(f"{dat_file_path} converted to .xlsx successfully at: {xlsx_file_path}")

        # Assuming there is only one .dat file in the directory, break the loop after processing it
        break
else:
    print("No .dat file found in the specified directory.")
