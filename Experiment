import pandas as pd

# Load the two Excel files into DataFrames
df1 = pd.read_excel('file1.xlsx')
df2 = pd.read_excel('file2.xlsx')

# Transpose both DataFrames
df1 = df1.T
df2 = df2.T

# Add headers for the first row
df1.columns = df1.iloc[0]
df2.columns = df2.iloc[0]

# Drop the first row (variable names) for both DataFrames
df1 = df1[1:]
df2 = df2[1:]

# Create DataFrames with 'Variable' and 'Values' columns
df3 = pd.DataFrame({'Variable': df1.index, 'Values': df1.values.flatten()})
df4 = pd.DataFrame({'Variable': df2.index, 'Values': df2.values.flatten()})

# Convert 'Values' column to numeric
df3['Values'] = pd.to_numeric(df3['Values'], errors='coerce')
df4['Values'] = pd.to_numeric(df4['Values'], errors='coerce')

# Calculate deviations in a new DataFrame
deviations = pd.DataFrame({'Variable': df3['Variable'], 'Deviation': ((abs(df4['Values'] - df3['Values']) / df3['Values']) * 100)})

# Filter variables with deviation > 5%
result_df = deviations[deviations['Deviation'] > 5]

# Print the resulting DataFrame with variable names and deviations
print(result_df)
