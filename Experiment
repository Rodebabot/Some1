import win32com.client
import datetime

# Connect to Outlook
outlook = win32com.client.Dispatch("Outlook.Application").GetNamespace("MAPI")

# Specify the mailbox, subfolders, and the folder where the email is located
mailbox_name = "Mailbox Name"
subfolder1_name = "Subfolder 1"
subfolder2_name = "Subfolder 2"
subfolder3_name = "Subfolder 3"
target_folder_name = "Target Folder"

# Get the mailbox
mailbox = outlook.Folders.Item(mailbox_name)

# Navigate to the subfolders
subfolder1 = mailbox.Folders.Item(subfolder1_name)
subfolder2 = subfolder1.Folders.Item(subfolder2_name)
subfolder3 = subfolder2.Folders.Item(subfolder3_name)
target_folder = subfolder3.Folders.Item(target_folder_name)

# Get today's date
today_date = datetime.datetime.now().date()

# Iterate through the items in the target folder
for item in target_folder.Items:
    if item.Class == 43:  # Mail item
        # Check if the email was received today
        if item.ReceivedTime.date() == today_date:
            # Get the attachments from the email
            attachments = item.Attachments
            if attachments.Count > 0:
                # Assuming you want to save the first attachment
                attachment = attachments.Item(1)
                attachment.SaveAsFile(r"C:\path\to\save\attachment")
                print("Attachment saved successfully.")
                break  # Stop iterating after processing the first email
else:
    print("No email with attachment found today.")
