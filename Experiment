import tkinter as tk
import pandas as pd
from tkinter.simpledialog import Autocomplete

# Read Excel file into a DataFrame
df = pd.read_excel('d.xlsx')

def search_client(event=None):
    client_name = entry.get()
    if client_name in df['Client Name'].values:
        fx_data = df.loc[df['Client Name'] == client_name, 'Fx Exception'].values[0]
        otc_data = df.loc[df['Client Name'] == client_name, 'otc Exception'].values[0]
        display_info(fx_data, otc_data)
    else:
        info_label.config(text="Client not found")

def display_info(fx_data, otc_data):
    info_label.config(text=f"FX Exception: {fx_data}\nOTC Exception: {otc_data}")

def update_autocomplete():
    client_names = df['Client Name'].tolist()
    autocomplete.set_completion_list(client_names)

root = tk.Tk()
root.title("Client Information Search")

label = tk.Label(root, text="Enter Client Name:")
label.pack(pady=10)

entry = Autocomplete(root)
entry.pack(pady=5)
entry.bind('<Return>', search_client)
entry.bind('<KeyRelease>', lambda event: update_autocomplete())

search_button = tk.Button(root, text="Search", command=search_client)
search_button.pack(pady=5)

info_label = tk.Label(root, text="")
info_label.pack(pady=10)

root.mainloop()
