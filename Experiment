import fitz  # PyMuPDF
import PyPDF2

def extract_images_with_text(pdf_path):
    images_with_text = []

    with open(pdf_path, 'rb') as file:
        pdf_reader = PyPDF2.PdfFileReader(file)

        for page_num in range(pdf_reader.numPages):
            page = pdf_reader.getPage(page_num)
            page_text = page.extractText()

            pdf_document = fitz.open(pdf_path)
            page_images = pdf_document[page_num].get_images(full=True)

            for img_index, img_info in enumerate(page_images):
                img_index += 1  # Adjust index since it starts from 1

                img_index_str = f"Image {img_index} on page {page_num + 1}"
                adjacent_text = page_text[img_info['y']-50:img_info['y']+50].strip()

                images_with_text.append({
                    'image_info': img_info,
                    'text': adjacent_text,
                    'location_info': img_index_str
                })

    return images_with_text

# Example usage
pdf_path = 'path/to/your/file.pdf'
result = extract_images_with_text(pdf_path)
for entry in result:
    print(entry['location_info'])
    print(f"Text around image: {entry['text']}")
    print("-" * 30)
