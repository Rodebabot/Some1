import pandas as pd

# Sample DataFrame creation for demonstration purposes
data = {
    'Type': ['External Open Buy', 'Internal Open Sell', 'Other Type', 'External Open Sell', 'Internal Open Buy', 'Another Type'],
    'Value': [100, 200, 300, 400, 500, 600]
}

df = pd.DataFrame(data)

# Define the list of types to keep
types_to_keep = [
    'External Open Buy', 
    'External Open Sell', 
    'Internal Open Buy', 
    'Internal Open Sell'
]

# Filter the DataFrame
filtered_df = df[df['Type'].isin(types_to_keep)]

print(filtered_df)
from openpyxl import load_workbook
from openpyxl.utils.dataframe import dataframe_to_rows

# Load the existing Excel file
existing_excel_file = 'existing_file.xlsx'
existing_wb = load_workbook(existing_excel_file)
existing_ws = existing_wb.active

# Convert appended_df to a list of rows
rows = list(dataframe_to_rows(appended_df, index=False, header=True))

# Write the rows to the Excel file starting from the 4th row
for i, row in enumerate(rows, start=1):
    for j, value in enumerate(row, start=1):
        existing_ws.cell(row=3 + i, column=j, value=value)

# Save the changes
existing_wb.save(existing_excel_file)
