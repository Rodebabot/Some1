import os
import pandas as pd

folder_path = 'path/to/your/excel/files'

# Create a new folder to store modified Excel files
output_folder = 'path/to/your/output/folder'
os.makedirs(output_folder, exist_ok=True)

def drop_first_three_rows(file_path, output_folder):
    # Read the Excel file
    df = pd.read_excel(file_path, engine='openpyxl', skiprows=3)

    # Construct the output file path with a new extension
    output_file = os.path.join(output_folder, os.path.basename(file_path))

    # Write the modified dataframe to the new Excel file
    df.to_excel(output_file, index=False)

# Iterate through all Excel files in the specified folder
for file_name in os.listdir(folder_path):
    if file_name.endswith('.xlsx') or file_name.endswith('.xls'):
        file_path = os.path.join(folder_path, file_name)
        drop_first_three_rows(file_path, output_folder)




import os
import pandas as pd

folder_path = 'path/to/your/excel/files'

# Create a new folder to store modified Excel files
output_folder = 'path/to/your/output/folder'
os.makedirs(output_folder, exist_ok=True)

def clean_and_shift(file_path, output_folder):
    # Read the Excel file
    df = pd.read_excel(file_path, engine='openpyxl', skiprows=3)

    # Iterate through each column starting from the second row
    for col in df.columns:
        # Identify non-blank cells
        non_blank_cells = df[col].notnull()

        # Shift the non-blank cells to the leftmost position
        df[col] = df[col][non_blank_cells].tolist()

    # Construct the output file path with a new extension
    output_file = os.path.join(output_folder, os.path.basename(file_path))

    # Write the modified dataframe to the new Excel file
    df.to_excel(output_file, index=False)

# Iterate through all Excel files in the specified folder
for file_name in os.listdir(folder_path):
    if file_name.endswith('.xlsx') or file_name.endswith('.xls'):
        file_path = os.path.join(folder_path, file_name)
        clean_and_shift(file_path, output_folder)

