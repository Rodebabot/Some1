import os
import datetime
from openpyxl import load_workbook
from pyxlsb import save_as_xlsb

# Specify the path to the XLSX file
xlsx_file_path = '/path/to/input_file.xlsx'

# Specify the previously saved name
saved_name = 'previously_saved_name'

# Get today's date in ddmm format
today_ddmm = datetime.datetime.now().strftime('%d%m')

# Create the output filename in the desired format
output_filename = f"{saved_name}-{today_ddmm}.xlsb"

# Load the XLSX file
wb = load_workbook(xlsx_file_path)

# Specify the output path for the XLSB file
xlsb_file_path = os.path.join(os.path.dirname(xlsx_file_path), output_filename)

# Save the XLSX file as XLSB format
save_as_xlsb(wb, xlsb_file_path)

print(f"XLSX file converted to XLSB format and saved as {output_filename}.")
