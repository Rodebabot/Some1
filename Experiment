import os
import datetime

folder_path = "/path/to/your/folder"
files = os.listdir(folder_path)
files.sort()

if files:
    first_file = files[0]
    last_file = files[-1]
    today = datetime.datetime.today()

    for i, file_name in enumerate(files):
        file_datetime = datetime.datetime.strptime(file_name, "%Y-%m-%d_%H-%M")
        delta = (today - file_datetime).days

        if delta == 0:
            suffix = "Sod"
        elif delta == 1:
            suffix = "Mod"
        elif delta == 2:
            suffix = "Eod"
        elif file_name == last_file:
            suffix = "Final"
        else:
            suffix = ""

        new_file_name = f"{file_name}_{suffix}"
        os.rename(os.path.join(folder_path, file_name), os.path.join(folder_path, new_file_name))










import os
import datetime

folder_path = "/path/to/your/folder"
files = os.listdir(folder_path)
files.sort()

if files:
    first_file = files[0]
    last_file = files[-1]
    today = datetime.datetime.today()

    for i, file_name in enumerate(files):
        file_name_without_extension, file_extension = os.path.splitext(file_name)
        file_datetime = datetime.datetime.strptime(file_name_without_extension, "%Y-%m-%d_%H-%M")
        delta = (today - file_datetime).days

        if delta == 0:
            suffix = "Sod"
        elif delta == 1:
            suffix = "Mod"
        elif delta == 2:
            suffix = "Eod"
        elif file_name == last_file:
            suffix = "Final"
        else:
            suffix = ""

        new_file_name = f"{file_name_without_extension}_{suffix}{file_extension}"
        os.rename(os.path.join(folder_path, file_name), os.path.join(folder_path, new_file_name))
