import pandas as pd
import tkinter as tk
from tkinter import ttk
import win32com.client as win32
from datetime import datetime

# Load data from Excel
file_path = '/path/to/your/excel/file.xlsx'
df = pd.read_excel(file_path)

# Function to get the user's name from Outlook
def get_outlook_username():
    outlook = win32.Dispatch("Outlook.Application")
    namespace = outlook.GetNamespace("MAPI")
    user = namespace.CurrentUser
    return user.Name

# Create the main Tkinter window
root = tk.Tk()
root.title("Claims Management App")

# Get user's name and current date/time
username = get_outlook_username()
current_datetime = datetime.now().strftime("%Y-%m-%d %H:%M:%S")

# Static Information Frame
static_frame = tk.Frame(root)
static_frame.pack(padx=10, pady=10, anchor='nw')

# Display username and date/time
tk.Label(static_frame, text=f"User: {username}").grid(row=0, column=0, sticky='w')
tk.Label(static_frame, text=f"Date/Time: {current_datetime}").grid(row=1, column=0, sticky='w')

# Display static rows
for i in range(3):
    row_text = ", ".join([str(df.iloc[i, j]) for j in range(df.shape[1])])
    tk.Label(static_frame, text=row_text).grid(row=i + 2, column=0, sticky='w')

# Scrollable Frame for Data
data_frame = tk.Frame(root)
data_frame.pack(fill='both', expand=True)

canvas = tk.Canvas(data_frame)
scrollbar = ttk.Scrollbar(data_frame, orient='vertical', command=canvas.yview)
scrollable_frame = ttk.Frame(canvas)

scrollable_frame.bind(
    "<Configure>",
    lambda e: canvas.configure(
        scrollregion=canvas.bbox("all")
    )
)

canvas.create_window((0, 0), window=scrollable_frame, anchor='nw')
canvas.configure(yscrollcommand=scrollbar.set)

for i in range(3, df.shape[0]):
    for j in range(3, 13):
        tk.Label(scrollable_frame, text=str(df.iloc[i, j])).grid(row=i, column=j-3)
    entry = tk.Entry(scrollable_frame)
    entry.grid(row=i, column=10)

canvas.pack(side="left", fill="both", expand=True)
scrollbar.pack(side="right", fill="y")

# Run the Tkinter event loop
root.mainloop()
