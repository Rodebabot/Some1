import fitz  # PyMuPDF
import os

def extract_and_save_images(pdf_path, output_folder):
    # Create output folder if it doesn't exist
    os.makedirs(output_folder, exist_ok=True)

    pdf_document = fitz.open(pdf_path)

    for page_num in range(len(pdf_document)):
        page = pdf_document[page_num]
        images = page.get_images(full=True)

        for img_index, img_info in enumerate(images):
            img_data = pdf_document.extract_image(img_info)
            img = Image.open(BytesIO(img_data['image']))
            img.save(os.path.join(output_folder, f"Image_Page_{page_num + 1}_{img_index + 1}.png"), "PNG")

    pdf_document.close()

# Example usage
pdf_path = 'path/to/your/file.pdf'
output_folder = 'path/to/your/output/folder'
extract_and_save_images(pdf_path, output_folder)
