import pandas as pd
from docx import Document

# Read the Excel file
excel_file = 'path/to/your/excel/file.xlsx'
df = pd.read_excel(excel_file)

# Read the Word document
docx_file = 'path/to/your/docx/file.docx'
doc = Document(docx_file)

# Create a dictionary to store the categories for each word
word_categories = dict(zip(df['Word'], df['Category']))

# Find categories in the Word document
categories_found = set()
for paragraph in doc.paragraphs:
    for word in word_categories:
        if word.lower() in paragraph.text.lower():
            categories_found.add(word_categories[word])

# Create a DataFrame with the results
result_df = pd.DataFrame({'Category found': [', '.join(categories_found)]})

# Save the result to a new Excel file
result_excel_file = 'path/to/your/result/file.xlsx'
result_df.to_excel(result_excel_file, index=False)

print(f'Results saved to {result_excel_file}')
