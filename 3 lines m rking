import pandas as pd
from openpyxl import load_workbook
from openpyxl.styles import PatternFill

# Assuming you have a DataFrame named 'reference_df' with columns 'Affected Countries' and 'Currency'
# Replace 'your_user_excel_file.xlsx' with the actual file path

reference_df = pd.DataFrame({
    'Affected Countries': ['Country1', 'Country2', 'Country3'],
    'Currency': ['Currency1', 'Currency2', 'Currency3']
})

user_excel_file_path = 'your_user_excel_file.xlsx'
user_df = pd.read_excel(user_excel_file_path)

# Create a PatternFill object for yellow color
yellow_fill = PatternFill(start_color='FFFF00', end_color='FFFF00', fill_type='solid')

# Load the Excel file
book = load_workbook(user_excel_file_path)
writer = pd.ExcelWriter(user_excel_file_path, engine='openpyxl')
writer.book = book

# Access the default sheet
sheet = book.active

# Iterate through rows and highlight if any value matches
for index, user_row in user_df.iterrows():
    for _, reference_row in reference_df.iterrows():
        if user_row.isin(reference_row).any():
            for cell in sheet[f"A{index+2}":"{sheet.max_column}{index+2}"]:
                for c in cell:
                    c.fill = yellow_fill

# Save the changes
writer.save()
