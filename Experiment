import pandas as pd

# Assuming df is your dataframe with columns 'name' and 'number'
# Function to mark rows with maximum number for each name
def mark_max(rows):
    max_number = rows['number'].max()
    rows['is_max'] = rows['number'] == max_number
    return rows

# Apply the function to the dataframe grouped by name
df_marked = df.groupby('name').apply(mark_max)

print(df_marked)
