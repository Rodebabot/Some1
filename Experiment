import tkinter as tk
from tkinter import ttk, messagebox
import pandas as pd
import webbrowser
import win32com.client as win32
from datetime import datetime
from PIL import Image, ImageTk

# Initialize a dictionary to keep track of keyword frequencies
keyword_frequencies = {}

# Load the Excel file into a DataFrame
df = pd.read_excel("your_excel_file.xlsx")

def rank_keywords(input_sentence):
    global keyword_frequencies
    
    # Tokenize the input sentence into words
    words = input_sentence.split()

    # Check each word for a match in the keyword column
    for word in words:
        keyword_matches = df[df['Keyword'].str.contains(word, case=False, na=False)]

        if not keyword_matches.empty:
            # Update the keyword frequencies
            for keyword in keyword_matches['Keyword']:
                if keyword in keyword_frequencies:
                    keyword_frequencies[keyword] += 1
                else:
                    keyword_frequencies[keyword] = 1

def search_keywords():
    global keyword_frequencies

    input_sentence = entry.get()

    # Perform keyword search and update frequencies
    rank_keywords(input_sentence)

    # Update the Excel sheet with keyword frequencies
    update_excel_with_keyword_frequencies()

    # Continue with other functionality (displaying results, opening links, etc.)

def update_excel_with_keyword_frequencies():
    global keyword_frequencies

    # Load the Excel file again
    df = pd.read_excel("your_excel_file.xlsx")

    # Update the DataFrame with the latest keyword frequencies
    for keyword, frequency in keyword_frequencies.items():
        # Check if the keyword already exists in the DataFrame
        if keyword in df['Keyword'].values:
            # Increment the existing frequency
            df.loc[df['Keyword'] == keyword, 'Frequency'] += frequency
        else:
            # Add a new row with the keyword and frequency
            new_row = {'Keyword': keyword, 'Frequency': frequency}
            df = df.append(new_row, ignore_index=True)

    # Save the updated DataFrame back to the Excel file
    df.to_excel("your_excel_file.xlsx", index=False)

# Create the main Tkinter window
root = tk.Tk()
root.title("Keyword Search App")

# ... (rest of your code remains the same)

# Create a button to trigger the keyword search
search_button = ttk.Button(root, text="Search", command=search_keywords)
search_button.grid(row=1, column=1, padx=10, pady=10)

root.mainloop()
