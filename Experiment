import os
import shutil
import datetime

# Get today's date
today_date = datetime.datetime.now().strftime('%d %b')

# Specify the parent directory path
parent_directory_path = '/path/to/parent_directory'

# Find the directory with recent Month and year naming like 'Feb 2024' in the specified parent directory
recent_month_year_directory = None
for directory_name in os.listdir(parent_directory_path):
    if os.path.isdir(os.path.join(parent_directory_path, directory_name)):
        if directory_name == datetime.datetime.now().strftime('%b %Y'):
            recent_month_year_directory = os.path.join(parent_directory_path, directory_name)
            break

# Create a directory with today's date inside the recent Month and year directory
if recent_month_year_directory:
    today_directory_path = os.path.join(recent_month_year_directory, today_date)
    os.makedirs(today_directory_path)
    print(f"Directory created: {today_directory_path}")
else:
    print("No directory found with recent Month and year naming.")

# Specify the location of the Excel file to move
excel_file_location = 'specified_location/excel_file.xlsx'

# Move the Excel file to the newly created directory
if recent_month_year_directory:
    if os.path.exists(excel_file_location):
        shutil.move(excel_file_location, today_directory_path)
        print(f"Excel file moved to: {today_directory_path}")
    else:
        print("Excel file not found at the specified location.")
else:
    print("Unable to move the Excel file as the recent Month and year directory is not found.")
