import os
import pandas as pd

# Function to read all sheets from an Excel file
def read_all_sheets_from_file(file_path):
    # Read all sheets into a dictionary of DataFrames
    all_dfs = pd.read_excel(file_path, sheet_name=None)
    
    # Return a list of DataFrames
    return list(all_dfs.values())

# Function to read Excel file from a directory
def read_excel_from_folder(folder_path):
    # Get list of files in the directory
    files = os.listdir(folder_path)
    
    # Filter Excel files
    excel_files = [file for file in files if file.endswith('.xlsx') or file.endswith('.xls')]
    
    # Check if there is more than one Excel file
    if len(excel_files) != 1:
        raise ValueError("There should be exactly one Excel file in the directory.")
    
    # Read the Excel file as DataFrame
    file_path = os.path.join(folder_path, excel_files[0])
    
    # Read all sheets from the Excel file
    return read_all_sheets_from_file(file_path)

# Example usage:
folder_path = input("Enter the folder path: ")
dfs = read_excel_from_folder(folder_path)

# Access each DataFrame individually
df1 = dfs[0]
df2 = dfs[1]
df3 = dfs[2]
