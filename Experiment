import pandas as pd

# Assuming dfp1 is your DataFrame

# Group by 'Obligor Org Rdmid' and aggregate the count, sum, and first values of 'Counterparty Name' and 'Entity'
new_df = dfp1.groupby('Obligor Org Rdmid', as_index=False).agg({
    'Amount USD': 'sum',          # sum of 'Amount USD'
    'Counterparty Name': 'first', # first occurrence of 'Counterparty Name'
    'Entity': 'first'             # first occurrence of 'Entity'
})

# Count the occurrences of 'Obligor Org Rdmid'
new_df['Count'] = dfp1['Obligor Org Rdmid'].value_counts().values

# Display the new DataFrame
print(new_df)
