import pandas as pd

# Assuming dfp1 is your DataFrame

# Group by 'Obligor Org Rdmid' and aggregate the count, sum, and first values of 'Counterparty Name' and 'Entity'
new_df = dfp1.groupby('Obligor Org Rdmid').agg({
    'Obligor Org Rdmid': 'size',  # count of occurrences
    'Amount USD': 'sum',          # sum of 'Amount USD'
    'Counterparty Name': 'first', # first occurrence of 'Counterparty Name'
    'Entity': 'first'             # first occurrence of 'Entity'
}).reset_index()                  # reset index to make 'Obligor Org Rdmid' a regular column

# Rename columns
new_df.columns = ['Obligor Org Rdmid', 'Count', 'Sum of Amount USD', 'Counterparty Name', 'Entity']

# Display the new DataFrame
print(new_df)
