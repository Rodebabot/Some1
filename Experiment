import pandas as pd

# Load the initial dataset and the dff1 dataset
initial_file_path = 'path_to_your_initial_file.xlsx'  # Replace with the actual file path of your initial dataset
dff1_file_path = 'path_to_your_dff1_file.xlsx'  # Replace with the actual file path of your dff1 dataset

# Read the datasets
initial_df = pd.read_excel(initial_file_path)
dff1 = pd.read_excel(dff1_file_path)

# Extract the relevant ROC values from dff1
relevant_rocs = dff1['ROC'].unique()

# Filter the initial dataset to keep only the rows with relevant ROCs
filtered_initial_df = initial_df[initial_df['ROC'].isin(relevant_rocs)]

# Save the filtered initial dataset to a new Excel file
filtered_initial_df.to_excel('filtered_initial_dataset_based_on_dff1.xlsx', index=False)
print("Filtered initial dataset based on dff1 ROCs has been saved to 'filtered_initial_dataset_based_on_dff1.xlsx'")
