import pandas as pd

# Load the dataset
file_path = '/mnt/data/your_excel_file.xlsx'  # Replace with the actual file path
df = pd.read_excel(file_path)

# Ensure the column names are correct as per the provided screenshot
df.columns = ['Unique Eventid', 'Legal Entity', 'Trade ID', 'ROC', 'Age', 'Age Band', 'Counterparty Name', 'Business Event', 'Product Representation', 'Days Spent', 'Action Items']

# Create a list of all unique ROC values
unique_rocs = df['ROC'].unique()

# Initialize a dictionary to hold the counts of unique event IDs for each ROC
roc_counts = {roc: 0 for roc in unique_rocs}

# Group the data by Unique Eventid and check the presence of each ROC
grouped = df.groupby('Unique Eventid')['ROC'].unique()

# Iterate over each group and count the presence of each ROC
for unique_eventid, rocs in grouped.items():
    for roc in rocs:
        roc_counts[roc] += 1

# Convert the dictionary to a DataFrame for better readability
roc_counts_df = pd.DataFrame(list(roc_counts.items()), columns=['ROC', 'Count of Unique Event IDs'])

# Display the results
print(roc_counts_df)

# Save the results to an Excel file
roc_counts_df.to_excel('/mnt/data/roc_counts.xlsx', index=False)

print("Counts of unique event IDs per ROC saved to roc_counts.xlsx")
