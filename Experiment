import win32com.client
import os

# Connect to Outlook
outlook = win32com.client.Dispatch("Outlook.Application").GetNamespace("MAPI")

# Specify the mailbox, inbox, and subfolder names
mailbox_name = "Mailbox Name"
inbox_folder_name = "Inbox"
subfolder_name = "Subfolder"

# Get the mailbox
mailbox = outlook.Folders.Item(mailbox_name)

# Navigate to the Inbox folder
inbox = mailbox.Folders.Item(inbox_folder_name)

# Navigate to the subfolder
subfolder = inbox.Folders.Item(subfolder_name)

# Find the email with the attachment
email_subject_contains = "Your Email Subject"  # Modify this to match your email subject
attachment_file_name_contains = "Attachment File Name"  # Modify this to match your attachment file name

found_email = None
for item in subfolder.Items:
    if item.Class == 43:  # Mail item
        if email_subject_contains in item.Subject:
            attachments = item.Attachments
            for attachment in attachments:
                if attachment_file_name_contains in attachment.FileName:
                    found_email = item
                    break

# Save the attachment
if found_email:
    save_folder_path = r"C:\path\to\save\attachments"
    os.makedirs(save_folder_path, exist_ok=True)
    
    attachments = found_email.Attachments
    for attachment in attachments:
        if attachment_file_name_contains in attachment.FileName:
            attachment.SaveAsFile(os.path.join(save_folder_path, attachment.FileName))
            print("Attachment saved successfully.")
            break
else:
    print("Email with the specified subject and attachment not found.")
