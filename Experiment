import win32com.client

def get_outlook_email():
    try:
        outlook = win32com.client.Dispatch("Outlook.Application").GetNamespace("MAPI")
        accounts = win32com.client.Dispatch("Outlook.Application").Session.Accounts
        email_addresses = []

        for account in accounts:
            email_addresses.append(account.SmtpAddress)

        return email_addresses
    except Exception as e:
        print(f"Error: {e}")
        return None

if __name__ == "__main__":
    outlook_emails = get_outlook_email()
    if outlook_emails:
        # Store the Outlook email addresses in a variable
        email_variable = ",".join(outlook_emails)
        print(f"Outlook Email Addresses: {email_variable}")
    else:
        print("Failed to retrieve Outlook email addresses.")
