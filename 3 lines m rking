import pandas as pd
from openpyxl import load_workbook
from openpyxl.styles import PatternFill

# Assuming you have a DataFrame named 'df' with columns 'Affected Countries' and 'Currency'
# Replace 'your_excel_file.xlsx' with the actual file path

file_path = 'your_excel_file.xlsx'
df = pd.read_excel(file_path)

# List of affected countries and currencies
affected_countries = ['Country1', 'Country2', 'Country3']
currencies = ['Currency1', 'Currency2', 'Currency3']

# Create a PatternFill object for yellow color
yellow_fill = PatternFill(start_color='FFFF00', end_color='FFFF00', fill_type='solid')

# Load the Excel file
book = load_workbook(file_path)
writer = pd.ExcelWriter(file_path, engine='openpyxl')
writer.book = book

# Access the default sheet
sheet = book.active

# Iterate through rows and highlight if any value matches
for index, row in df.iterrows():
    for col in df.columns:
        if row[col] in affected_countries or row[col] in currencies:
            for cell in sheet[f"{col}{index+2}":"{sheet.max_column}{index+2}"]:
                for c in cell:
                    c.fill = yellow_fill

# Save the changes
writer.save()
