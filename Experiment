import tkinter as tk
from tkinter import ttk
from tkinter import messagebox
import openpyxl

# Function to handle the 'Submit' button
def submit():
    team = team_var.get()
    task = task_var.get()
    option = option_var.get()
    
    if option == "Fixed":
        result.set(data[team][task]["value"])
    else:
        try:
            value = float(entry.get())
            result.set(value * data[team][task]["value"])
        except ValueError:
            messagebox.showerror("Error", "Please enter a valid number.")

# Load data from Excel file (adjust the filename and sheet name)
workbook = openpyxl.load_workbook('your_excel_file.xlsx')
sheet = workbook['your_sheet_name']

data = {}

# Iterate through the Excel sheet and populate the data dictionary
for row in sheet.iter_rows(min_row=2, values_only=True):
    team_name = row[0]
    task_name = row[1]
    option = row[2]
    value = row[3]
    
    if team_name not in data:
        data[team_name] = {}
    
    data[team_name][task_name] = {"option": option, "value": value}

# Create the main application window
app = tk.Tk()
app.title("Excel Data App")

# Initialize variables
team_var = tk.StringVar()
task_var = tk.StringVar()
option_var = tk.StringVar()
result = tk.StringVar()
result.set("Result will appear here")

# Create dropdowns for team and task selection
team_label = ttk.Label(app, text="Select Team:")
team_label.pack()
teams = list(data.keys())
team_dropdown = ttk.Combobox(app, textvariable=team_var, values=teams)
team_dropdown.pack()

def update_task_dropdown(event):
    selected_team = team_var.get()
    tasks_for_team = list(data[selected_team].keys())
    task_dropdown["values"] = tasks_for_team

team_dropdown.bind("<<ComboboxSelected>>", update_task_dropdown)

task_label = ttk.Label(app, text="Select Task:")
task_label.pack()
task_dropdown = ttk.Combobox(app, textvariable=task_var, values=[])
task_dropdown.pack()

# Create dropdown for option selection
option_label = ttk.Label(app, text="Select Option:")
option_label.pack()
option_dropdown = ttk.Combobox(app, textvariable=option_var, values=["Fixed", "Variable"])
option_dropdown.pack()

# Entry for entering variable value
entry_label = ttk.Label(app, text="Enter Value:")
entry_label.pack()
entry = ttk.Entry(app)

entry.pack()


# Create a 'Submit' button
submit_button = ttk.Button(app, text="Submit", command=submit)
submit_button.pack()

# Display the result
result_label = ttk.Label(app, textvariable=result)
result_label.pack()

# Start the application
app.mainloop()





# Function to handle the 'Submit' button
def submit():
    team = team_var.get()
    task = task_var.get()
    
    if team in data and task in data[team]:
        option = data[team][task]["option"]
        
        if option == "Fixed":
            result.set(data[team][task]["value"])
        else:
            try:
                value = float(entry.get())
                result.set(value * data[team][task]["value"])
            except ValueError:
                messagebox.showerror("Error", "Please enter a valid number.")
    else:
        messagebox.showerror("Error", "Team and task not found in data.")

# ...


