import pandas as pd
import re
import os

# Step 1: Read Excel File
df = pd.read_excel('your_excel_file.xlsx')

# Step 2: Define a Function to Extract Categories
def extract_categories(file_path, keywords):
    with open(file_path, 'r') as file:
        content = file.read()
        matches = [category for word, category in keywords if re.search(fr'\b{word}\b', content, re.IGNORECASE)]
        return ', '.join(matches) if matches else None

# Step 3: Process Files and Generate Output
output_data = {'File': [], 'Categories': []}

for index, row in df.iterrows():
    file_path = f'path/to/your/files/{row["Col1"]}.txt'  # Adjust the path and extension accordingly
    categories = extract_categories(file_path, zip(df['Col1'], df['col2']))
    output_data['File'].append(file_path)
    output_data['Categories'].append(categories)

output_df = pd.DataFrame(output_data)

# Step 4: Write Output to Excel
output_df.to_excel('output_categories.xlsx', index=False)
