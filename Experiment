import tkinter as tk
from tkinter import ttk
import webbrowser
import pandas as pd

# Load data from an Excel file
try:
    data = pd.read_excel('your_excel_file.xlsx', engine='openpyxl')
except FileNotFoundError:
    # Handle the case where the Excel file is not found
    data = pd.DataFrame(columns=["Keyword", "DisplayWord", "URL"])

def open_url():
    selected_display_word = display_word_var.get()
    url = data[data["DisplayWord"] == selected_display_word]["URL"].values[0]
    webbrowser.open(url)

def calculate_match_score(search_keywords, keywords):
    return len(search_keywords.intersection(keywords))

def update_display_words(*args):
    search_keywords = set(search_var.get().lower().split())
    exact_match = None  # Initialize as None
    suggestions = []
    best_match_score = 0

    for _, row in data.iterrows():
        keywords = set(str(row["Keyword"]).lower().split())
        match_score = calculate_match_score(search_keywords, keywords)

        if search_var.get().lower() == row["Keyword"].lower():  # Exact match found
            exact_match = row["DisplayWord"]
        elif match_score > best_match_score:
            best_match_score = match_score
            suggestions = [row["DisplayWord"]]
        elif match_score == best_match_score:
            suggestions.append(row["DisplayWord"])

    if exact_match:
        display_word_combobox['values'] = [exact_match]
    else:
        display_word_combobox['values'] = suggestions

app = tk.Tk()
app.title("Keyword Search App")

search_label = ttk.Label(app, text="Enter keywords:")
search_label.pack(pady=10)

search_var = tk.StringVar()
search_entry = ttk.Entry(app, textvariable=search_var)
search_entry.pack()

display_word_label = ttk.Label(app, text="Select a display word:")
display_word_label.pack(pady=10)

display_word_var = tk.StringVar()
display_word_combobox = ttk.Combobox(app, textvariable=display_word_var)
display_word_combobox.pack()

search_var.trace_add("write", update_display_words)

open_button = ttk.Button(app, text="Open URL", command=open_url)
open_button.pack(pady=10)

app.mainloop()
