import pandas as pd
from openpyxl import Workbook
from openpyxl.styles import Font
from openpyxl.styles import PatternFill

# Sample DataFrame
data = {'A': [-1, 2, -3, 4],
        'B': ['apple', -6, 'banana', -8],
        'C': ['red', 'blue', 'green', 'yellow']}
df = pd.DataFrame(data)

# Identify numeric columns
numeric_cols = df.select_dtypes(include=['number']).columns

# Remove the minus sign from negative values in numeric columns
df[numeric_cols] = df[numeric_cols].applymap(lambda x: abs(x) if isinstance(x, int) or isinstance(x, float) else x)

# Export DataFrame to Excel
excel_file = 'output.xlsx'
sheet_name = 'Sheet1'

# Create a workbook and select the active worksheet
wb = Workbook()
ws = wb.active

# Write the DataFrame to the worksheet
for r_idx, row in enumerate(df.iterrows(), 1):
    for c_idx, value in enumerate(row[1], 1):
        ws.cell(row=r_idx, column=c_idx, value=value)

# Apply conditional formatting to increase font size for negative values
for col_idx, col_name in enumerate(df.columns):
    if col_name in numeric_cols:
        for row_idx, cell in enumerate(ws[col_idx + 1], 1):
            if cell.value is not None and cell.value < 0:
                cell.font = Font(size=12)

# Save the Excel file
wb.save(filename=excel_file)
