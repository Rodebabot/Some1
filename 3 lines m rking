import pandas as pd

# Assuming you have a DataFrame named 'df' with columns 'Affected Countries' and 'Currency'
# Replace 'your_excel_file.xlsx' with the actual file path

file_path = 'your_excel_file.xlsx'
new_df = pd.read_excel(file_path)

# Assuming df is your existing DataFrame with columns 'Affected Countries' and 'Currency'
# If not, replace it with the actual DataFrame name

affected_countries = set(df['Affected Countries'].dropna())
currencies = set(df['Currency'].dropna())

# Create a mask for rows that contain values from the specified columns
mask = new_df.apply(lambda row: any(value in affected_countries or value in currencies for value in row), axis=1)

# Create a new DataFrame containing only the rows that match the criteria
df2 = new_df[mask]

# Drop the other rows from the original DataFrame
new_df = new_df[mask]

# If you want to reset the index of the new DataFrame
df2.reset_index(drop=True, inplace=True)
new_df.reset_index(drop=True, inplace=True)
