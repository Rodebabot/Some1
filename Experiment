import pandas as pd
from scipy.stats import trim_mean

# Load the dataset
file_path = '/mnt/data/your_excel_file.xlsx'  # Replace with the actual file path
df = pd.read_excel(file_path)

# Ensure the column names are correct as per the provided screenshot
df.columns = ['Unique Eventid', 'Legal Entity', 'Trade ID', 'ROC', 'Age', 'Age Band', 'Counterparty Name', 'Business Event', 'Product Representation', 'Days Spent', 'Action Items']

# Group by ROC and calculate the average days spent
roc_avg_days = df.groupby('ROC')['Days Spent'].mean().reset_index()

# Define the percentage to trim from each end of the data
trim_percent = 0.1  # Trimming 10% from each end

# Calculate the trimmed mean for the overall life days that a ROC should take
ideal_life_days = trim_mean(roc_avg_days['Days Spent'], proportiontocut=trim_percent)

# Display the result
print(f"The recommended overall life days that a ROC should ideally take is: {ideal_life_days:.2f} days")
