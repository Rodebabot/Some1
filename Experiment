import os
import re
from datetime import datetime
import shutil

def extract_date(filename):
    match = re.search(r'(\d{2} \w+)\.xlsx', filename)
    if match:
        return datetime.strptime(match.group(1), '%d %B')
    return None

def get_latest_file(directory):
    latest_date = None
    latest_file = None

    for filename in os.listdir(directory):
        date = extract_date(filename)
        if date and (latest_date is None or date > latest_date):
            latest_date = date
            latest_file = filename

    return latest_file

def copy_latest_file(src_directory, dest_directory):
    latest_file = get_latest_file(src_directory)
    if latest_file:
        src_path = os.path.join(src_directory, latest_file)
        dest_path = os.path.join(dest_directory, 'FX_Latest.xlsx')
        shutil.copyfile(src_path, dest_path)
        print(f"Copied {latest_file} to {dest_path}")
    else:
        print("No files found with a valid date in the filename.")

# Example usage
src_directory = 'path_to_source_directory'  # Replace with your source directory path
dest_directory = 'path_to_destination_directory'  # Replace with your destination directory path
copy_latest_file(src_directory, dest_directory)
