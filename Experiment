import win32com.client
import requests
from urllib.parse import urlparse

def download_file(url, save_path):
    response = requests.get(url)
    with open(save_path, 'wb') as file:
        file.write(response.content)

def save_file_from_outlook():
    outlook = win32com.client.Dispatch("Outlook.Application").GetNamespace("MAPI")
    inbox = outlook.GetDefaultFolder(6)  # 6 represents the Inbox folder

    # Assuming you want to process the latest email
    message = inbox.Items.GetLast()

    # Extracting the link from the email body
    link = "extracted_link_from_email"

    # Extracting the file name from the URL
    file_name = urlparse(link).path.split("/")[-1]

    # Specify the destination path where you want to save the file
    save_path = "C:/path/to/save/" + file_name

    # Download the file
    download_file(link, save_path)

# Example usage
save_file_from_outlook()
