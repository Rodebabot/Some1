import win32com.client
import os
import datetime

# Connect to Outlook
outlook = win32com.client.Dispatch("Outlook.Application").GetNamespace("MAPI")

# Specify the mailbox, inbox, and subfolder names
mailbox_name = "Mailbox Name"
inbox_folder_name = "Inbox"
subfolder_name = "Subfolder"

# Get the mailbox
mailbox = outlook.Folders.Item(mailbox_name)

# Navigate to the Inbox folder
inbox = mailbox.Folders.Item(inbox_folder_name)

# Navigate to the subfolder
subfolder = inbox.Folders.Item(subfolder_name)

# Get today's date
today_date = datetime.datetime.now().date()

# Find the first email received today
first_email = None
for item in subfolder.Items:
    if item.Class == 43:  # Mail item
        if item.ReceivedTime.date() == today_date:
            first_email = item
            break

# Save the attachment from the first email of the day
if first_email:
    save_folder_path = r"C:\path\to\save\attachments"
    os.makedirs(save_folder_path, exist_ok=True)
    
    attachments = first_email.Attachments
    if attachments.Count > 0:
        # Assuming you want to save the first attachment
        attachment = attachments.Item(1)
        attachment.SaveAsFile(os.path.join(save_folder_path, attachment.FileName))
        print("Attachment saved successfully.")
    else:
        print("No attachments found in the first email of the day.")
else:
    print("No email received today in the specified folder.")
